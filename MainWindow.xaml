<Window x:Class="StartupManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:StartupManager"
        Title="启动程序管理器" Height="580" Width="900"
        MinHeight="450" MinWidth="700"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#FF2C3E50"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <Style x:Key="InfoTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#FF7F8C8D"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
        </Style>
        
        <Style x:Key="DeleteButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#FFE74C3C"/>
            <Setter Property="Content" Value="删除"/>
            <Setter Property="Width" Value="60"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFC0392B"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题和说明 -->
        <StackPanel Grid.Row="0">
            <TextBlock Text="Windows 开机启动程序管理器" Style="{StaticResource HeaderTextStyle}"/>
            <TextBlock Text="管理您的开机启动程序，通过快捷方式实现自动启动（用户级权限）" Style="{StaticResource InfoTextStyle}"/>
        </StackPanel>
        
        <!-- 工具栏 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
            <Button Name="BtnAdd" Content="添加程序" Click="BtnAdd_Click" Margin="0,0,10,0"/>
            <Button Name="BtnRefresh" Content="刷新列表" Click="BtnRefresh_Click" Margin="0,0,10,0"/>
            <Button Name="BtnOpenFolder" Content="打开启动文件夹" Click="BtnOpenFolder_Click"/>
        </StackPanel>
        
        <!-- 启动项列表 -->
        <ListView Grid.Row="2" Name="LvStartupItems" 
                  SelectionMode="Single"
                  GridViewColumnHeader.Click="GridViewColumnHeader_Click">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="程序名称" Width="180" DisplayMemberBinding="{Binding Name}"/>
                    <GridViewColumn Header="程序路径" Width="350" DisplayMemberBinding="{Binding Path}"/>
                    <GridViewColumn Header="启动参数" Width="140" DisplayMemberBinding="{Binding Arguments}"/>
                    <GridViewColumn Header="添加时间" Width="110" DisplayMemberBinding="{Binding DateAdded, StringFormat=yyyy-MM-dd}"/>
                    <GridViewColumn Header="操作" Width="80">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Button Style="{StaticResource DeleteButtonStyle}" 
                                        Click="BtnDelete_Click" 
                                        Tag="{Binding}"
                                        ToolTip="删除此启动项"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
        
        <!-- 状态栏 -->
        <StatusBar Grid.Row="3" Height="25" Margin="0,10,0,0">
            <StatusBarItem>
                <TextBlock Name="TbStatus" Text="就绪"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Name="TbItemCount" Text="共 0 个启动项"/>
            </StatusBarItem>
        </StatusBar>
        
        <!-- 底部信息 -->
        <StackPanel Grid.Row="4" Margin="0,10,0,0">
            <TextBlock FontSize="10" Foreground="#FF95A5A6" HorizontalAlignment="Center">
                <Run Text="启动文件夹位置: "/>
                <Run Name="RunStartupPath"/>
            </TextBlock>
        </StackPanel>
    </Grid>
</Window>
